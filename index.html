<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RS AUTO EXPO LLC | Marketing & Sales Services Ledger</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f1f5f9; color: #1e293b; }
        .navy-bg { background-color: #001F3F; }
        .navy-text { color: #001F3F; }
        
        /* Print Fixes */
        .print-text { display: none; }
        
        @media print {
            .no-print { display: none !important; }
            body { background: white !important; padding: 0 !important; }
            .container-box { border: none !important; box-shadow: none !important; margin: 0 !important; max-width: 100% !important; width: 100% !important; }
            
            /* Hide inputs and show the text layer for PDF */
            input, select { display: none !important; }
            
            .print-text { 
                display: block !important; 
                min-height: 1.2em;
                overflow: visible;
                font-size: 9pt !important;
                color: #000 !important;
                word-break: break-all; /* Prevent VIN from pushing table width */
            }

            .status-paid { background-color: #dcfce7 !important; color: #15803d !important; -webkit-print-color-adjust: exact; }
            .status-unpaid { background-color: #fee2e2 !important; color: #b91c1c !important; -webkit-print-color-adjust: exact; }
            .navy-bg { background-color: #001F3F !important; -webkit-print-color-adjust: exact; }
            
            table { table-layout: auto !important; width: 100% !important; }
            th, td { padding: 4px !important; }
        }

        .status-paid { background-color: #dcfce7; color: #15803d; font-weight: 900; }
        .status-unpaid { background-color: #fee2e2; color: #b91c1c; font-weight: 900; }
        
        input { background: transparent; outline: none; width: 100%; border-bottom: 1px solid transparent; transition: border 0.2s; }
        input:focus { border-bottom: 1px solid #cbd5e1; }
        input::placeholder { color: #cbd5e1; font-weight: 400; font-size: 0.75rem; }

        /* Force table containment */
        .table-container {
            width: 100%;
            overflow-x: hidden; /* No horizontal scroll */
        }
        table {
            width: 100%;
            table-layout: fixed; /* Ensures column widths are strictly obeyed */
        }
    </style>
</head>
<body class="p-2 md:p-6">

    <div class="max-w-6xl mx-auto bg-white shadow-2xl rounded-[1.5rem] overflow-hidden border border-slate-200 container-box">
        
        <!-- HEADER SECTION -->
        <div class="p-6 md:p-10 border-b border-slate-100 flex flex-col md:flex-row justify-between items-start gap-6">
            <div class="flex flex-col md:flex-row items-center gap-6">
                <div class="relative group no-print">
                    <div class="bg-white p-2 rounded-xl shadow-sm border border-slate-100 w-24 h-24 flex items-center justify-center overflow-hidden">
                        <img id="logoPreview" src="" alt="Logo" class="hidden w-full h-full object-contain">
                        <div id="logoPlaceholder" class="text-center p-1">
                            <span class="text-[8px] font-bold text-slate-400 uppercase">Logo</span>
                        </div>
                    </div>
                    <input type="file" id="logoUpload" accept="image/*" class="absolute inset-0 opacity-0 cursor-pointer" onchange="handleLogo(this)">
                </div>
                
                <div class="text-center md:text-left">
                    <h1 class="text-4xl font-black navy-text tracking-tighter uppercase">RS AUTO EXPO LLC</h1>
                    <p class="text-slate-500 text-[10px] font-bold uppercase tracking-widest mt-1">8180 Regent Parkway, Suite 118, Fort Mill, SC 29715</p>
                    <p class="text-blue-600 text-xs font-bold mt-1">Rsautoexpo25@gmail.com | +1 407 300 8164</p>
                </div>
            </div>
            
            <div class="bg-blue-50/50 p-6 rounded-2xl border-l-[4px] border-[#001F3F] w-full md:w-80">
                <p class="font-black text-slate-900 text-sm uppercase mb-1">MARKETING AND SALES SERVICES</p>
                <p class="text-slate-600 text-[9px] font-bold uppercase leading-tight">C/1263 GBEDJROMEDE, Benin</p>
                <p class="text-slate-700 text-xs font-bold mt-1">0022997979997</p>
            </div>
        </div>

        <!-- SUMMARY DASHBOARD -->
        <div class="p-6 bg-white grid grid-cols-1 md:grid-cols-3 gap-4 border-b border-slate-100">
            <div class="bg-slate-50 p-6 rounded-2xl border border-slate-100">
                <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">Unpaid Inventory</p>
                <p id="totalInv" class="text-2xl font-black text-slate-900">$0.00</p>
            </div>
            <div class="bg-slate-50 p-6 rounded-2xl border border-slate-100">
                <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">Wires Received</p>
                <p id="totalWire" class="text-2xl font-black text-blue-600">$0.00</p>
            </div>
            <div class="navy-bg p-6 rounded-2xl shadow-lg">
                <p class="text-[9px] font-black text-blue-300 uppercase tracking-widest mb-1">Balance Due</p>
                <p id="totalBal" class="text-2xl font-black text-white">$0.00</p>
            </div>
        </div>

        <!-- TOOLBAR -->
        <div class="px-6 py-4 bg-white border-b flex flex-wrap items-center gap-2 no-print">
            <button onclick="addRow('cars')" class="bg-[#001F3F] text-white px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-blue-900 shadow-md">+ Add Vehicle</button>
            <button onclick="addRow('wires')" class="bg-blue-600 text-white px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-blue-700 shadow-md">+ Add Wire</button>
            <div class="flex-grow"></div>
            <input type="file" id="importFile" class="hidden" onchange="importData(this)">
            <button onclick="document.getElementById('importFile').click()" class="bg-white border px-3 py-2 rounded-xl text-[10px] font-black text-slate-600 uppercase">Import</button>
            <button onclick="downloadBackup()" class="bg-slate-100 text-slate-600 px-3 py-2 rounded-xl text-[10px] font-black uppercase">Backup</button>
            <button onclick="window.print()" class="bg-[#001F3F] text-white px-6 py-2 rounded-xl text-[10px] font-black uppercase shadow-md">Print PDF</button>
        </div>

        <!-- CONTENT -->
        <div class="p-6 md:p-8 space-y-12">
            <section>
                <div class="flex items-center gap-3 mb-4">
                    <div class="h-6 w-1 navy-bg rounded-full"></div>
                    <h3 class="text-[11px] font-black text-slate-900 uppercase tracking-widest">Board A: Vehicle Inventory</h3>
                </div>
                <div class="table-container rounded-xl border border-slate-100">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="text-[9px] font-black text-slate-400 uppercase tracking-widest bg-slate-50/50">
                                <th class="p-3 w-14">Year</th>
                                <th class="p-3 w-1/4">Model</th>
                                <th class="p-3 w-1/4">VIN</th>
                                <th class="p-3 w-20 text-right">Price</th>
                                <th class="p-3 w-20 text-center">Status</th>
                                <th class="p-3 w-24 text-right">Remaining</th>
                                <th class="p-3 w-8 no-print"></th>
                            </tr>
                        </thead>
                        <tbody id="carTable" class="divide-y divide-slate-50 text-[11px]"></tbody>
                    </table>
                </div>
            </section>

            <section class="max-w-2xl">
                <div class="flex items-center gap-3 mb-4">
                    <div class="h-6 w-1 bg-blue-500 rounded-full"></div>
                    <h3 class="text-[11px] font-black text-slate-900 uppercase tracking-widest">Board B: Wire Transfers</h3>
                </div>
                <div class="table-container rounded-xl border border-slate-100 shadow-sm">
                    <table class="w-full text-left">
                        <thead class="bg-blue-50 text-[9px] font-black text-blue-700 uppercase tracking-widest">
                            <tr>
                                <th class="p-3 w-28">Date</th>
                                <th class="p-3">Reference</th>
                                <th class="p-3 w-32 text-right">Amount</th>
                                <th class="p-3 w-8 no-print"></th>
                            </tr>
                        </thead>
                        <tbody id="wireTable" class="divide-y divide-slate-50 text-[11px]"></tbody>
                    </table>
                </div>
            </section>
        </div>

        <div class="p-6 bg-slate-50 text-center border-t border-slate-100">
            <p class="text-[9px] font-black text-slate-400 uppercase tracking-[0.3em]">RS AUTO EXPO LLC - CONFIDENTIAL</p>
        </div>
    </div>

    <script>
        const storageKey = 'rs_marketing_benin_ledger_v2';
        const curFormatter = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' });

        let state = JSON.parse(localStorage.getItem(storageKey)) || {
            cars: [{ year: '', model: '', vin: '', price: 0, status: 'UNPAID' }],
            wires: [{ date: '', ref: 'Wire Transfer', amount: 0 }],
            logo: null
        };

        function saveState() {
            localStorage.setItem(storageKey, JSON.stringify(state));
        }

        function calculateTotals() {
            let invTotal = 0;
            let wireTotal = 0;

            const carRows = document.querySelectorAll('#carTable tr');
            state.cars.forEach((c, i) => {
                const rem = c.status === 'PAID' ? 0 : (c.price || 0);
                invTotal += rem;
                if (carRows[i]) {
                    carRows[i].querySelector('.row-rem').innerText = curFormatter.format(rem);
                }
            });

            state.wires.forEach(w => {
                wireTotal += (w.amount || 0);
            });

            document.getElementById('totalInv').innerText = curFormatter.format(invTotal);
            document.getElementById('totalWire').innerText = curFormatter.format(wireTotal);
            document.getElementById('totalBal').innerText = curFormatter.format(invTotal - wireTotal);
        }

        function handleLogo(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    state.logo = e.target.result;
                    const img = document.getElementById('logoPreview');
                    img.src = state.logo;
                    img.classList.remove('hidden');
                    document.getElementById('logoPlaceholder').classList.add('hidden');
                    saveState();
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function updateField(type, index, key, val, el) {
            state[type][index][key] = (key === 'price' || key === 'amount') ? parseFloat(val) || 0 : val;
            const printSpan = el.parentElement.querySelector('.print-text');
            if(printSpan) printSpan.innerText = val;
            saveState();
            calculateTotals();
        }

        function addRow(type) {
            if (type === 'cars') state.cars.push({ year: '', model: '', vin: '', price: 0, status: 'UNPAID' });
            else state.wires.push({ date: '', ref: 'Wire Transfer', amount: 0 });
            saveState();
            fullRender();
        }

        function removeRow(type, index) {
            if(confirm('Delete entry?')) {
                state[type].splice(index, 1);
                saveState();
                fullRender();
            }
        }

        function downloadBackup() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(state));
            const dl = document.createElement('a');
            dl.setAttribute("href", dataStr);
            dl.setAttribute("download", "RS_BENIN_Backup.json");
            dl.click();
        }
        
        function importData(input) {
            const reader = new FileReader();
            reader.onload = e => {
                state = JSON.parse(e.target.result);
                saveState();
                fullRender();
            };
            reader.readAsText(input.files[0]);
        }

        function fullRender() {
            const cBody = document.getElementById('carTable');
            const wBody = document.getElementById('wireTable');
            cBody.innerHTML = ''; 
            wBody.innerHTML = '';
            
            if(state.logo) {
                const img = document.getElementById('logoPreview');
                img.src = state.logo;
                img.classList.remove('hidden');
                document.getElementById('logoPlaceholder').classList.add('hidden');
            }

            state.cars.forEach((c, i) => {
                const tr = document.createElement('tr');
                tr.className = "hover:bg-slate-50 transition-colors";
                tr.innerHTML = `
                    <td class="p-3"><span class="print-text">${c.year}</span><input type="text" value="${c.year}" oninput="updateField('cars',${i},'year',this.value, this)" placeholder="2024" class="font-bold"></td>
                    <td class="p-3"><span class="print-text">${c.model}</span><input type="text" value="${c.model}" oninput="updateField('cars',${i},'model',this.value, this)" placeholder="Model" class="font-bold truncate"></td>
                    <td class="p-3"><span class="print-text text-[9px] break-all leading-tight">${c.vin}</span><input type="text" value="${c.vin}" oninput="updateField('cars',${i},'vin',this.value, this)" placeholder="VIN" class="uppercase text-[9px] tracking-tight"></td>
                    <td class="p-3 text-right"><span class="print-text">${c.price}</span><input type="number" value="${c.price}" oninput="updateField('cars',${i},'price',this.value, this)" class="font-bold text-right"></td>
                    <td class="p-3 text-center">
                        <span class="print-text text-[8px] font-black ${c.status === 'PAID' ? 'text-green-600' : 'text-red-600'}">${c.status}</span>
                        <select onchange="updateField('cars',${i},'status',this.value, this); fullRender();" class="text-[8px] font-black p-1 rounded-lg outline-none cursor-pointer ${c.status === 'PAID' ? 'status-paid' : 'status-unpaid'}">
                            <option value="UNPAID" ${c.status === 'UNPAID' ? 'selected' : ''}>UNPAID</option>
                            <option value="PAID" ${c.status === 'PAID' ? 'selected' : ''}>PAID</option>
                        </select>
                    </td>
                    <td class="p-3 text-right font-black row-rem">${curFormatter.format(c.status === 'PAID' ? 0 : c.price)}</td>
                    <td class="p-3 no-print text-center"><button onclick="removeRow('cars',${i})" class="text-slate-200 hover:text-red-500 text-[9px]">✕</button></td>
                `;
                cBody.appendChild(tr);
            });

            state.wires.forEach((w, i) => {
                const tr = document.createElement('tr');
                tr.className = "hover:bg-blue-50/50 transition-colors";
                tr.innerHTML = `
                    <td class="p-3"><span class="print-text">${w.date}</span><input type="date" value="${w.date}" oninput="updateField('wires',${i},'date',this.value, this)" class="text-[10px]"></td>
                    <td class="p-3"><span class="print-text">${w.ref}</span><input type="text" value="${w.ref}" oninput="updateField('wires',${i},'ref',this.value, this)" class="font-medium"></td>
                    <td class="p-3 text-right font-black text-blue-600"><span class="print-text text-right">${w.amount}</span><input type="number" value="${w.amount}" oninput="updateField('wires',${i},'amount',this.value, this)" class="text-right"></td>
                    <td class="p-3 no-print text-center"><button onclick="removeRow('wires',${i})" class="text-slate-200 hover:text-red-500 text-[9px]">✕</button></td>
                `;
                wBody.appendChild(tr);
            });

            calculateTotals();
        }

        fullRender();
    </script>
</body>
</html>
